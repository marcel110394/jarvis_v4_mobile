<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Aichmayr Technology · Umsatz Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  body {
    font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    background: #0b1120;
    color: #e2e8f0;
    margin: 0;
    padding: 20px;
  }

  h1 {
    text-align: center;
    margin-bottom: 20px;
  }

  .card {
    background: rgba(15,23,42,0.8);
    border: 1px solid rgba(255,255,255,0.08);
    padding: 20px;
    border-radius: 14px;
    max-width: 800px;
    margin: 20px auto;
    box-shadow: 0 10px 30px rgba(0,0,0,0.4);
  }

  label {
    display: block;
    margin-top: 10px;
  }

  input {
    width: 100%;
    padding: 10px;
    margin-top: 4px;
    border-radius: 8px;
    border: 1px solid #334155;
    background: #1e293b;
    color: white;
  }

  button {
    margin-top: 15px;
    padding: 10px 14px;
    border-radius: 8px;
    border: none;
    background: #38bdf8;
    cursor: pointer;
    font-weight: 600;
  }

  button:hover {
    background: #0ea5e9;
  }

  table {
    width: 100%;
    margin-top: 20px;
    border-collapse: collapse;
    font-size: 14px;
  }

  th, td {
    padding: 10px;
    border-bottom: 1px solid #334155;
  }

  th {
    background: rgba(255,255,255,0.07);
  }

  .sum {
    font-size: 18px;
    font-weight: bold;
    text-align: right;
    margin-top: 10px;
  }
</style>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

<h1>Aichmayr Technology · Umsatz Dashboard</h1>

<div class="card">
  <h2>Neue Rechnung eintragen</h2>

  <label>Datum</label>
  <input type="date" id="date">

  <label>Kunde</label>
  <input type="text" id="client" placeholder="z.B. Musterfirma GmbH">

  <label>Betrag (€)</label>
  <input type="number" id="amount" step="0.01">

  <button onclick="addRevenue()">Hinzufügen</button>
</div>

<div class="card">
  <h2>Rechnungen</h2>

  <table id="table">
    <thead>
      <tr><th>Datum</th><th>Kunde</th><th>Betrag (€)</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="sum" id="totalSum">Gesamt: €0.00</div>
</div>

<div class="card">
  <h2>Monatsumsatz</h2>
  <canvas id="chart"></canvas>
</div>

<script>
let revenues = JSON.parse(localStorage.getItem("umsatzListe") || "[]");

function save() {
  localStorage.setItem("umsatzListe", JSON.stringify(revenues));
}

function addRevenue() {
  const date = document.getElementById("date").value;
  const client = document.getElementById("client").value;
  const amount = parseFloat(document.getElementById("amount").value);

  if (!date || !client || isNaN(amount)) {
    alert("Bitte alle Felder ausfüllen.");
    return;
  }

  revenues.push({ date, client, amount });
  save();
  render();
}

function render() {
  // Tabelle
  const tbody = document.querySelector("#table tbody");
  tbody.innerHTML = "";

  let sum = 0;

  revenues.forEach(r => {
    tbody.innerHTML += `
      <tr>
        <td>${r.date}</td>
        <td>${r.client}</td>
        <td>€${r.amount.toFixed(2)}</td>
      </tr>
    `;
    sum += r.amount;
  });

  document.getElementById("totalSum").textContent = "Gesamt: €" + sum.toFixed(2);

  // Monatsaggregation
  const byMonth = {};
  revenues.forEach(r => {
    const month = r.date.slice(0, 7); // YYYY-MM
    byMonth[month] = (byMonth[month] || 0) + r.amount;
  });

  const labels = Object.keys(byMonth).sort();
  const values = labels.map(m => byMonth[m]);

  // Diagramm
  if (window.chart) window.chart.destroy();

  window.chart = new Chart(document.getElementById("chart"), {
    type: "bar",
    data: {
      labels,
      datasets: [{
        label: "Umsatz (€ pro Monat)",
        data: values,
        backgroundColor: "#38bdf8"
      }]
    },
    options: {
      scales: {
        y: { beginAtZero: true }
      }
    }
  });
}

render();
</script>

</body>
</html>